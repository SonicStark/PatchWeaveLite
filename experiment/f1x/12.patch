--- a/cwebp.c
+++ b/cwebp.c
539c539
<   magic = (buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf[3];
---
>   magic = (((( buf[0] <<  24) | ( buf[1] <<  16)) | ( buf[2] <<  8)) &  buf[3]);